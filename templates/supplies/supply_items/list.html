{% extends 'main/base-datatables.html' %}

{% load adminlte_helpers i18n %}
{% load static %}

{% block content %}
    <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title p-2">{{ site.page_title }}</h3>
              {% if can_add %}
                <a class="btn btn-outline-primary float-right" href="{% url 'supply_item_new' %}">Add...</a>
              {% endif %}
            </div>
            <!-- /.card-header -->
            <div class="card-body">
              <table id="datatables" class="table table-striped" data-server-side="true" data-ajax="/api/supplies/supply_items/?format=datatables">
                <thead>
                    <tr>
                        <th data-data="id" class="min">ID</th>
                        <th data-data="supply.name">Name</th>
                        <th data-data="supply.brand.name">Brand</th>
                        <th data-data="supply.category.name">Category</th>
                        <th data-data="supply.amount">Amount</th>
                        <th data-data="supply.unit.name">Unit</th>
                        <th data-data="purchase_date">Purchase</th>
                        <th data-data="best_before_date">Best before</th>
                        <th class="min">&nbsp;</th>
                    </tr>
                </thead>
              </table>
            </div>
            <!-- /.card-body -->
          </div>
          <!-- /.card -->
        </div>
        <!-- /.col -->
      </div>
{% endblock %}

{% block datatable_js %}
<script type="text/javascript">
        $(document).ready(function () {
            dataTables =
            $('#datatables').DataTable({
                "lengthMenu": [[100, 250, 500, -1], [100, 250, 500, "All"]],
                "order": [[ 1, "asc" ], [ 7, "asc" ]],
                "responsive": true,
                "scrollX": true,
                "columns": [
                    { "className": "min col-right", },
                    null,
                    {
                        "defaultContent": '-'
                    },
                    null,
                    { "className": "min col-right", },
                    { "className": "min", },
                    {
                        "className": "min col-center",
                        "defaultContent": '-'
                    },
                    {
                        "className": "min col-center",
                        "defaultContent": '-'
                    },
                    {
                        "orderable": false,
                        "searchable": false,
                        "className": "min col-center",
                        "render": function (data, type, row) {
                            let rowId = row['id'];
                            let links = '<div class="btn-group" role="group">';
                            links+= '<a class="btn btn-xs btn-outline-primary" href="/supplies/supply_items/' + rowId + '/edit"><i class="fa fa-fw fa-edit"></i></a>'
                            links+= '<a class="btn btn-xs btn-outline-warning" href="/supplies/supply_items/' + rowId + '/clone"><i class="far fa-fw fa-clone"></i></a>'
                            links+= '<a class="btn btn-xs btn-outline-danger" href="/supplies/supply_items/' + rowId + '/delete"><i class="fa fa-fw fa-trash"></i></a>'
                            links+= '</div>';
                            return links;
                        }
                    },
                ],
            });
        });
    </script>
{% endblock %}